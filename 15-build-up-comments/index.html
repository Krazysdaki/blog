<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="一个谜的一堆谜"/>
<meta name="keywords" content="一个谜的一堆谜"/>
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://iknect.me/favicon.ico">
<link rel="stylesheet" href="https://iknect.me/styles/main.css">
<!-- Modernizr JS -->
<script src="https://cdn.staticfile.org/modernizr/2.6.2/modernizr.min.js"></script>
<!-- Comment -->

<!-- katex -->
<!--<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet">-->
<link href="https://cdn.bootcss.com/font-awesome/5.13.0/css/all.css" rel="stylesheet">


<title>15 静态博客的最佳评论系统：Deserts 改版 Valine - Knect 的博客</title>
</head>
<body>
    <div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://iknect.me/images/avatar.png" alt="Knect 的博客"
                 class="img-responsive">
        </figure>
        <a href="https://iknect.me/about/"><h3 class="heading">ABOUT ME</h3></a>
        <h2>Knect 的博客</h2>
        <p>一个谜的一堆谜</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>
    <div class="fh5co-menu">
        <!-- 标签 -->
        <div class="fh5co-box">
            <a href="https://iknect.me/tags/"><h3 class="heading">👉标签</h3></a>
            <ul>
                
                    <li><a href="https://iknect.me/tag/Owwh3mi-0/">生活</a></li>
                
                    <li><a href="https://iknect.me/tag/0UX8Q6f5W/">flag</a></li>
                
                    <li><a href="https://iknect.me/tag/T3-WvHPcql/">丧</a></li>
                
                    <li><a href="https://iknect.me/tag/PcaUYvi6v4/">九九计划</a></li>
                
                    <li><a href="https://iknect.me/tag/pb_uUzm_rC/">折腾</a></li>
                
                    <li><a href="https://iknect.me/tag/ogeVvi8y-H/">思维</a></li>
                
                    <li><a href="https://iknect.me/tag/3kLqxV9jrp/">博客</a></li>
                
                    <li><a href="https://iknect.me/tag/XvPJ6_P-Q6/">工具</a></li>
                
            </ul>
        </div>
    </div>
</div>
<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="https://iknect.me/movies"
                        
                        >
                            观影
                        </a>
                    </li>
                
                    <li>
                        <a href="https://iknect.me/books"
                        
                        >
                            阅读
                        </a>
                    </li>
                
                    <li>
                        <a href="https://iknect.me"
                        
                        >
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a href="https://iknect.me/archives"
                        
                           target="_blank"
                                
                        >
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a href="https://iknect.me/tags"
                        
                           target="_blank"
                                
                        >
                            标签
                        </a>
                    </li>
                
                <p></p>
                <form id="gridea-search-form" data-update="1586833711828" action="/search/">
                    <input class="gridea-search-input" autocomplete="off" spellcheck="false" name="q">
                </form>
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://iknect.me">Knect 的博客 </a>
                </h1>
            </div>
        </div>
    </div>
</header>

    
        <div class="container-fluid">
    <div class="row fh5co-post-entry single-entry">
        <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
            <p></p>
            <figure class="animate-box">
                
                    <img src="https://yanxuan.nosdn.127.net/e402ec2a279a71bb96e2a7d897038637.png" alt="15 静态博客的最佳评论系统：Deserts 改版 Valine" class="img-responsive">
                
            </figure>
            <span class="fh5co-meta animate-box">
                
                    <div class="tag-container">
                        
                            <a href="https://iknect.me/tag/pb_uUzm_rC/" class="tag">折腾, </a>
                        
                            <a href="https://iknect.me/tag/3kLqxV9jrp/" class="tag">博客, </a>
                        
                    </div>
                
            </span>
            <h2 class="fh5co-article-title animate-box">15 静态博客的最佳评论系统：Deserts 改版 Valine</h2>
            <ol class="breadcrumb fh5co-meta fh5co-date animate-box" style="margin-bottom:0; background-color:#f8f9fa">
                <li>2018-09-20, 22:59:50</li>
                <li>1404字</li>
                <li>6 min read</li>
            </ol>

            <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                <div class="row">
                    <div class="col-md-12 animate-box post-content">
                        <p> <p>~</p>
<p><strong>这是九九计划</strong><br>
<strong>第 <font color=coral>15</font> 篇</strong></p>
<p>~</p>
<h2 id="前言">前言</h2>
<p>静态博客最令人烦恼的问题，可能是没有一款好用的评论系统。</p>
<p>之前我通过苦苦地检索、尝试、修改，终于发现了和我胃口的评论系统 <code>Valine</code> ，之后又找到了 <code>panjunwen</code> 大佬的修改版，简直喜欢得不行。<br>
你说一个一点不懂 <code>Javascript</code> 和 <code>HTML</code> 的菜鸡，想自己添加一个评论系统会有多难呢？大佬们的教程总不可能事无巨细，所以碰到的问题还真不少。<br>
遗憾的是上次太懒了没有把整个过程记录下来。</p>
<p>昨天整理浏览器书签栏（项目那是真的多，太难整理了），偶然打开 panjunwen 大佬的博客，发现有更新，更喜欢了。<br>
今天把它更新上来，同时不偷懒地把过程记录下来~<br>
本文使用本博客的 InkPaper 程序为例，其他博客大同小异。<br>
黑喂狗。</p>
<p><strong>注意：如果你，访客，想要从头开始加入这个评论系统，请拉到文末看参考链接部署，本文不是完整的教程。</strong></p>
<h2 id="修改主题模板">修改主题模板</h2>
<p><strong>注意：此处需要一点 HTML 和 Javascript 语法。</strong></p>
<p>静态博客文件夹下通常有个 <code>theme</code> 文件夹，里边就是博客的主题模板。<br>
我的博客如图所示：</p>
<figure data-type="image" tabindex="1"><img src="https://ws1.sinaimg.cn/large/006xA1mJgy1fvgc0u2ug8j30dq0flt9p.jpg" alt="Ink 博客程序主题模板文件夹" loading="lazy"></figure>
<p>我这里 <code>_comment.html</code> 显然就是博客本来自带的评论模块，于是我的所有操作只要在这个文件里面进行就可以了。<br>
用Notepad++打开该文件，将预置的评论模块删去，注意保留博客必需的语句。<br>
比如在我这里，只要将 <code>{{if .Site.Comment}}</code> 和 <code>{{end}}</code> 之间的全部删掉即可。</p>
<p>我在中间先加一行 <code>&lt;div class=&quot;comments&quot;&gt;&lt;/div&gt;</code><br>
然后加</p>
<pre><code class="language-html">&lt;!--（可选）引入 jquery 此句无需修改--&gt;  
&lt;script src=&quot;//cdnjs.cat.net/ajax/libs/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt;  
&lt;!--引入 Leancloud 操作库 此句无需修改--&gt;  
&lt;script src=&quot;//cdn1.lncld.net/static/js/3.0.4/av-min.js&quot;&gt;&lt;/script&gt;  
&lt;!--引入评论模块 此句需要修改--&gt;  
&lt;script src=&quot;./bundle/Valine.min.js&quot;&gt;&lt;/script&gt;  
&lt;script&gt;  
	new Valine({  
		av: AV,  
		el: '.comments',  
		emoticon_url: &quot;https://blog.knect.win/alu&quot;,  
		emoticon_list: [&quot;吐.png&quot;,&quot;喷血.png&quot;,&quot;狂汗.png&quot;,&quot;不说话.png&quot;,&quot;汗.png&quot;,&quot;坐等.png&quot;,&quot;献花.png&quot;,&quot;不高兴.png&quot;,&quot;中刀.png&quot;,&quot;害羞.png&quot;,&quot;皱眉.png&quot;,&quot;小眼睛.png&quot;,&quot;中指.png&quot;,&quot;尴尬.png&quot;,&quot;瞅你.png&quot;,&quot;想一想.png&quot;,&quot;中枪.png&quot;,&quot;得意.png&quot;,&quot;肿包.png&quot;,&quot;扇耳光.png&quot;,&quot;亲亲.png&quot;,&quot;惊喜.png&quot;,&quot;脸红.png&quot;,&quot;无所谓.png&quot;,&quot;便便.png&quot;,&quot;愤怒.png&quot;,&quot;蜡烛.png&quot;,&quot;献黄瓜.png&quot;,&quot;内伤.png&quot;,&quot;投降.png&quot;,&quot;观察.png&quot;,&quot;看不见.png&quot;,&quot;击掌.png&quot;,&quot;抠鼻.png&quot;,&quot;邪恶.png&quot;,&quot;看热闹.png&quot;,&quot;口水.png&quot;,&quot;抽烟.png&quot;,&quot;锁眉.png&quot;,&quot;装大款.png&quot;,&quot;吐舌.png&quot;,&quot;无奈.png&quot;,&quot;长草.png&quot;,&quot;赞一个.png&quot;,&quot;呲牙.png&quot;,&quot;无语.png&quot;,&quot;阴暗.png&quot;,&quot;不出所料.png&quot;,&quot;咽气.png&quot;,&quot;期待.png&quot;,&quot;高兴.png&quot;,&quot;吐血倒地.png&quot;,&quot;哭泣.png&quot;,&quot;欢呼.png&quot;,&quot;黑线.png&quot;,&quot;喜极而泣.png&quot;,&quot;喷水.png&quot;,&quot;深思.png&quot;,&quot;鼓掌.png&quot;,&quot;暗地观察.png&quot;],  
		app_id: '6v4OuSH2D5bIkmCAIcd9ADxQ-gzGz##加密##',  
		app_key: 'bIj1fgfi3H03gujB8xNy##加密##',  
		placeholder: '\\(≧▽≦)/你想说什么呢'  
    })  
&lt;/script&gt;  
</code></pre>
<ol>
<li>自行托管 <code>Valine.min.js</code> 文件（可利用好CDN），并将 <code>Valine.min.js</code> 所在句的引号内内容改成该托管文件的地址。下载： <a href="https://dl.knect.win/Script/Valine.min.js">Valine.min.js</a></li>
<li>自行托管表情文件，将 <code>emoticon_url</code> 后引号内的内容改为托管的表情文件夹地址。下载： <a href="https://dl.knect.win/images/alu.zip">表情压缩包</a></li>
<li>自行编辑 <code>emoticon_list</code> 项，选择需要的表情。可结合 <code>2</code> 点，自定义自己的表情。</li>
<li><code>app_id</code> 和 <code>app_key</code> 两项在 <code>Leancloud</code> 取得，请参考文末参考链接。</li>
<li><code>placeholder</code> 为评论框默认显示的文字。</li>
</ol>
<p>至此，评论模块已经部署完毕，重新构建一次博客，即可展现~<br>
评论管理后台 请参考文末参考链接。</p>
<h2 id="后台管理">后台管理</h2>
<p>请参考文末链接。</p>
<p><strong>【10.12更新】</strong><br>
使用 <a href="https://panjunwen.com">panjunwen</a> 的<a href="https://panjunwen.com/valine-admin-document/">Valine-Admin</a>。</p>
<p>更新勤快~ 功能完善~</p>
<p>加上这个后台，Valine 已经趋近完美~</p>
<p><s>不过我用的不是 panjunwen 大佬的后台，我用了 <a href="https://github.com/zhaojun1998/Valine-Admin">zhaojun1998</a> 的后台。</s></p>
<p><s><strong>更新</strong> ：后来又改回 panjunwen 大佬的了，因为发现 zhaojun1998 大佬的好似没法检测到被@ 。</s></p>
<p><s>邮件问题大了。</s></p>
<p><s>之前在 zhaojun1998 大佬的后台上用一个 Office 365 A1 管理员的邮箱，不知怎么发不出了。</s><br>
<s>改成 panjunwen 大佬的后台后，无法登陆上 Outlook365</s> 。<br>
<s>想申请个好用的，翻了半天，要么很恶心，要么收费，找不着。</s><br>
<s>QQ邮箱大小号已经设置过英文邮箱了，很烦。</s><br>
<s>而且小号必须实名认证才能用SMTP，更气的是我耐着性子做认证时还不通过。</s><br>
<s>于是现在将就用着一个163。</s></p>
<p><s>夜深了，先这样吧。</s></p>
<hr>
<h3 id="参考链接">参考链接</h3>
<p>panjunwen 的魔改 Valine 介绍页（有些内容已过时失效）： https://panjunwen.com/diy-a-comment-system/<br>
panjunwen 的 Valine Admin 配置手册： https://panjunwen.com/valine-admin-document/<br>
zhaojun1998 大佬的 Valine Admin ： https://github.com/zhaojun1998/Valine-Admin<br>
云淡风轻的原版 Valine 介绍页： https://ioliu.cn/2017/add-valine-comments-to-your-blog/<br>
原版 Valine 主页（此页有内容已过时）： https://valine.js.org/</p>
<hr>
<p>ＴＨＥ－ＥＮＤ</p>
 </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 animate-box">
                        
                            <div class="next-post">
                                <div class="next">下一篇</div>
                                <a href="https://iknect.me/14-me-myself-and-my-father/">
                                    <h3 class="post-title">
                                        14 我，我自己，和我父亲
                                    </h3>
                                </a>
                            </div>
                        
                    </div>
                </div>

                <div class="row">
    <div class="col-md-12 animate-box">
                    <div class="valine-container"></div>
    </div>
</div>

            </div>

        </article>
    </div>
</div>

    
    <!-- jQuery -->
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- img lazy load -->
<script src="https://cdnjs.loli.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>
<!-- jQuery Easing -->
<script src="https://cdnjs.loli.net/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<!-- Bootstrap -->
<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://cdn.staticfile.org/waypoints/4.0.0/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://iknect.me/media/scripts/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://iknect.me/media/scripts/md5.min.js"></script>
<!-- katex -->
<!--<script src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js"></script>-->
<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
<script src="/media/scripts/Valine.min.js"></script>
<script type="application/javascript">
    hljs.initHighlightingOnLoad();
    $(function () {
        $("img.lazy").lazyload({
            effect: "fadeIn",  // 懒加载动画
            threshold: 180  // 在图片距离屏幕180px时提前载入
        });
        jQuery('[data-toggle="tooltip"]').tooltip();
        $('#tool-toc').click(function () {
            $('.post-toc').toggle();
        });
    });
    
</script>


    
        <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
        <script>
            new Valine({
                av: AV, 
                el: '.valine-container',
                emoticon_url: 'https://iknect.me/images/alu',
                emoticon_list: ["击掌.png","献花.png","害羞.png","献黄瓜.png","口水.png","惊喜.png","喷血.png","吐血倒地.png",
                "狂汗.png","欢呼.png","高兴.png","喜极而泣.png","不说话.png","脸红.png","汗.png","坐等.png","不高兴.png",
                "中刀.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png",
                "肿包.png","扇耳光.png","亲亲.png","吐.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","内伤.png",
                "投降.png","观察.png","看不见.png","抠鼻.png","邪恶.png","看热闹.png","抽烟.png","锁眉.png","装大款.png",
                "吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png",
                "期待.png","哭泣.png","黑线.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],
                app_id: '6v4OuSH2D5bIkmCAIcd9ADxQ-gzGzoHsz',
                app_key: 'bIj1fgfi3H03gujB8xNyxwd2',
                admin_email: 'pdly@live.cn',
                placeholder: '\\(≧▽≦)/你想说什么呢'
            });
        </script>
    
    
    



    <div class="back-to-top">
    
        <a href="#!" id="tool-toc" class="hidden-xs hidden-sm">
            <i class="fa fa-map"></i>
        </a>
        <br>
    
    <a href="#top" class="hidden-xs hidden-sm"><i class="fa fa-paper-plane"></i></a>
</div>
<div class="post-toc animated fadeInRight hidden-xs hidden-sm" style="display: none;">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%A2%98%E6%A8%A1%E6%9D%BF">修改主题模板</a></li>
<li><a href="#%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86">后台管理</a>
<ul>
<li><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

    
<footer id="fh5co-footer">
  <p>© 2020 Knect 的博客. All Rights Reserved. <br/>
由 <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> & <a href="https://github.com/GalaxySuze/gridea-theme-space" target="_blank">Space</a> 轻快驱动</p>
</footer>

</body>
</html>
